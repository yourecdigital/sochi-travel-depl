# Custom Fail2Ban Filters for Sochi Travel

[Definition]
# Nginx SQL Injection
failregex = ^<HOST> -.*"(GET|POST).*?(union|select|insert|delete|drop|script|alert).*?" (4|5)\d\d
ignoreregex =

[Definition]
# Nginx XSS Attacks
failregex = ^<HOST> -.*"(GET|POST).*?(<script|javascript:|vbscript:|onload=|onerror=).*?" (4|5)\d\d
ignoreregex =

[Definition]
# Nginx Directory Traversal
failregex = ^<HOST> -.*"(GET|POST).*?(\.\.\/|\.\.\\|%2e%2e%2f|%2e%2e%5c).*?" (4|5)\d\d
ignoreregex =

[Definition]
# Nginx Brute Force Login
failregex = ^<HOST> -.*"POST /api/auth/login.*?" (4|5)\d\d
ignoreregex =

[Definition]
# Nginx Rate Limiting
failregex = limiting requests, excess:.* by zone.*client: <HOST>
ignoreregex =
